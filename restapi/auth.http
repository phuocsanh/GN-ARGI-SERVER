### ===== AUTHENTICATION APIs =====

### User registration (using user module)
POST http://localhost:8080/users
Content-Type: application/json

{
  "userAccount": "newuser@gmail.com",
  "userPassword": "12345678",
  "userSalt": "salt123",
  "userEmail": "newuser@gmail.com",
  "userState": 1
}

### @name login
# Save token from login response
@access_token = {{login.response.body.data.accessToken}}
@refresh_token = {{login.response.body.data.refreshToken}}

### Get all users
GET http://localhost:8080/users

### Get user by ID
GET http://localhost:8080/users/1

### Update a user
PATCH http://localhost:8080/users/1
Content-Type: application/json

{
  "userAccount": "updated_phuocsanhtps@gmail.com",
  "userEmail": "updated_phuocsanhtps@gmail.com"
}

### Delete a user
DELETE http://localhost:8080/users/1

### User login
POST http://localhost:8080/auth/login
Content-Type: application/json

{
  "userAccount": "phuocsanhtps@gmail.com",
  "userPassword": "12345678"
}

### Refresh token
POST http://localhost:8080/auth/refresh
Content-Type: application/json

{
  "refreshToken": "{{refresh_token}}"
}

### Update tokens after refresh
# @access_token = {{refresh.response.body.data.accessToken}}
# @refresh_token = {{refresh.response.body.data.refreshToken}}

### User logout
POST http://localhost:8080/auth/logout
Content-Type: application/json
Authorization: Bearer {{access_token}}

### Setup two-factor authentication
POST http://localhost:8080/auth/two-factor/setup
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "userId": 1,
  "twoFactorAuthType": "EMAIL",
  "twoFactorEmail": "test@example.com"
}

### Verify two-factor authentication
POST http://localhost:8080/auth/two-factor/verify
Content-Type: application/json
Authorization: Bearer {{access_token}}

{
  "userId": 1,
  "twoFactorCode": "123456"
}

# Đăng ký người dùng mới
POST http://localhost:8080/auth/register
Content-Type: application/json

{
  "userAccount": "testuser",
  "userPassword": "testpassword",
  "userSalt": "salt123",
  "userEmail": "test@example.com"
}

###

# Đăng nhập để lấy token
POST http://localhost:8080/auth/login
Content-Type: application/json

{
  "userAccount": "testuser",
  "userPassword": "testpassword"
}

###

# Đổi mật khẩu (cần token từ đăng nhập)
PUT http://localhost:8080/auth/change-password
Authorization: Bearer {{auth_token}}
Content-Type: application/json

{
  "oldPassword": "testpassword",
  "newPassword": "newpassword123"
}
